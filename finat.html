
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>finat package &#8212; FInAT 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/fenics.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to FInAT’s documentation!" href="index.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" width="900px" alt="FInAT Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="https://github.com/FInAT/finat" title="GitHub">GitHub</a></li>
<!--          <li class="page_item"><a href="documentation.html" title="Documentation for FInAT">Documentation</a></li>
          <li class="page_item"><a href="download.html" title="Obtain the FInAT code">Download</a></li>
          <li class="page_item"><a href="team.html" title="The guilty parties">Team</a></li>
          <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
          <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
          <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
          <li class="page_item"><a href="http://buildbot-ocean.ese.ic.ac.uk:8080/builders/FInAT-trunk" title="Buildbot">Buildbot</a></li>-->
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="finat-package">
<h1>finat package<a class="headerlink" href="#finat-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-finat.argyris">
<span id="finat-argyris-module"></span><h2>finat.argyris module<a class="headerlink" href="#module-finat.argyris" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.argyris.Argyris">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.argyris.</span></span><span class="sig-name descname"><span class="pre">Argyris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/argyris.html#Argyris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.argyris.Argyris" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.argyris.Argyris.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/argyris.html#Argyris.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.argyris.Argyris.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.aw">
<span id="finat-aw-module"></span><h2>finat.aw module<a class="headerlink" href="#module-finat.aw" title="Permalink to this heading">¶</a></h2>
<p>Implementation of the Arnold-Winther finite elements.</p>
<dl class="py class">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.aw.</span></span><span class="sig-name descname"><span class="pre">ArnoldWinther</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWinther"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWinther" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWinther.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWinther.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>The extra 6 dofs removed here correspond to the constraints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWinther.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWinther.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWinther.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWinther.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.aw.ArnoldWinther.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWinther.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWinther.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWinther.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.aw.</span></span><span class="sig-name descname"><span class="pre">ArnoldWintherNC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWintherNC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWintherNC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWintherNC.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWintherNC.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Note, the extra 3 dofs which are removed here
correspond to the constraints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWintherNC.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWintherNC.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWintherNC.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWintherNC.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.aw.ArnoldWintherNC.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.aw.ArnoldWintherNC.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/aw.html#ArnoldWintherNC.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.aw.ArnoldWintherNC.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.bell">
<span id="finat-bell-module"></span><h2>finat.bell module<a class="headerlink" href="#module-finat.bell" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.bell.Bell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.bell.</span></span><span class="sig-name descname"><span class="pre">Bell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/bell.html#Bell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.bell.Bell" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.bell.Bell.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/bell.html#Bell.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.bell.Bell.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.bell.Bell.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/bell.html#Bell.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.bell.Bell.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.bell.Bell.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.bell.Bell.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.bell.Bell.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/bell.html#Bell.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.bell.Bell.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.cube">
<span id="finat-cube-module"></span><h2>finat.cube module<a class="headerlink" href="#module-finat.cube" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.cube.</span></span><span class="sig-name descname"><span class="pre">FlattenedDimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Class for elements on quadrilaterals and hexahedra.  Wraps a tensor
product element on a tensor product cell, and flattens its entity
dimensions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.entity_permutations">
<span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.entity_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/cube.html#FlattenedDimensions.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.cube.FlattenedDimensions.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.cube.FlattenedDimensions.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.cube.FlattenedDimensions.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.direct_serendipity">
<span id="finat-direct-serendipity-module"></span><h2>finat.direct_serendipity module<a class="headerlink" href="#module-finat.direct_serendipity" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">DirectSerendipity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.DirectlyDefinedElement" title="finat.physically_mapped.DirectlyDefinedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectlyDefinedElement</span></code></a>, <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.mapping">
<span class="sig-name descname"><span class="pre">mapping</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity.mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#DirectSerendipity.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.direct_serendipity.DirectSerendipity.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.direct_serendipity.DirectSerendipity.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.diff">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiate expr with respect to xx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> – symengine/symengine Expression to differentiate.</p></li>
<li><p><strong>xx</strong> – iterable of coordinates to differentiate with respect to.</p></li>
<li><p><strong>alpha</strong> – derivative multiindex, one entry for each entry of xx
indicating how many derivatives in that direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New symengine/symengine expression.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.ds1_sym">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">ds1_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp=&lt;module</span> <span class="pre">'symengine'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/symengine/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#ds1_sym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.ds1_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs lowest-order case of Arbogast’s directly defined C^0 serendipity
elements, which are a special case.
:param ct: The cell topology of the reference quadrilateral.
:param vs: (Optional) coordinates of cell on which to construct the basis.</p>
<blockquote>
<div><p>If it is None, this function constructs symbols for the vertices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a 3-tuple containing symbols for the physical cell coordinates and the
physical cell independent variables (e.g. “x” and “y”) and a list
of the four basis functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.ds_sym">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">ds_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp=&lt;module</span> <span class="pre">'symengine'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/symengine/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#ds_sym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.ds_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbolically Constructs Arbogast’s directly defined C^0 serendipity elements,
which include all polynomials of degree r plus a couple of rational functions.
:param ct: The cell topology of the reference quadrilateral.
:param vs: (Optional) coordinates of cell on which to construct the basis.</p>
<blockquote>
<div><p>If it is None, this function constructs symbols for the vertices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a 3-tuple containing symbols for the physical cell coordinates and the
physical cell independent variables (e.g. “x” and “y”) and a list
of the four basis functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.dsr_sym">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">dsr_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp=&lt;module</span> <span class="pre">'symengine'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/symengine/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#dsr_sym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.dsr_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs higher-order (&gt;= 2) case of Arbogast’s directly defined C^0 serendipity
elements, which include all polynomials of degree r plus a couple of rational
functions.
:param ct: The cell topology of the reference quadrilateral.
:param vs: (Optional) coordinates of cell on which to construct the basis.</p>
<blockquote>
<div><p>If it is None, this function constructs symbols for the vertices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a 3-tuple containing symbols for the physical cell coordinates and the
physical cell independent variables (e.g. “x” and “y”) and a list
of the four basis functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.newton_dd">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">newton_dd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#newton_dd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.newton_dd" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs Newton’s divided differences for the input arrays,
which may include symbolic values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.newton_poly">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">newton_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#newton_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.newton_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs  Lagrange interpolating polynomial passing through
x values nds and y values fs.  Returns a a symbolic object in terms
of independent variable xsym.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.direct_serendipity.xysub">
<span class="sig-prename descclassname"><span class="pre">finat.direct_serendipity.</span></span><span class="sig-name descname"><span class="pre">xysub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/direct_serendipity.html#xysub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.direct_serendipity.xysub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-finat.discontinuous">
<span id="finat-discontinuous-module"></span><h2>finat.discontinuous module<a class="headerlink" href="#module-finat.discontinuous" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.discontinuous.</span></span><span class="sig-name descname"><span class="pre">DiscontinuousElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Element wrapper that makes a FInAT element discontinuous.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
<li><p><strong>coordinate_mapping</strong> – a
<a class="reference internal" href="#finat.physically_mapped.PhysicalGeometry" title="finat.physically_mapped.PhysicalGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalGeometry</span></code></a> object that
provides physical geometry callbacks (may be None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.entity_permutations">
<span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.entity_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.formdegree">
<span class="sig-name descname"><span class="pre">formdegree</span></span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.formdegree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/discontinuous.html#DiscontinuousElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.discontinuous.DiscontinuousElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.discontinuous.DiscontinuousElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.enriched">
<span id="finat-enriched-module"></span><h2>finat.enriched module<a class="headerlink" href="#module-finat.enriched" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.enriched.</span></span><span class="sig-name descname"><span class="pre">EnrichedElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>A finite element whose basis functions are the union of the
basis functions of several other finite elements.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.degree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.degree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.entity_permutations">
<span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.entity_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to the map of
orientations to permutation lists for the finite element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.formdegree">
<span class="sig-name descname"><span class="pre">formdegree</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.formdegree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.index_shape">
<span class="sig-name descname"><span class="pre">index_shape</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.index_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.is_mixed">
<span class="sig-name descname"><span class="pre">is_mixed</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.is_mixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.is_mixed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.enriched.EnrichedElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.enriched.EnrichedElement.value_shape">
<span class="sig-name descname"><span class="pre">value_shape</span></span><a class="reference internal" href="_modules/finat/enriched.html#EnrichedElement.value_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.EnrichedElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.enriched.concatenate_entity_dofs">
<span class="sig-prename descclassname"><span class="pre">finat.enriched.</span></span><span class="sig-name descname"><span class="pre">concatenate_entity_dofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#concatenate_entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.concatenate_entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the entity DoFs from a list of elements into a combined
dict containing the information for the concatenated DoFs of all
the elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_el</strong> – the reference cell</p></li>
<li><p><strong>elements</strong> – subelement whose DoFs are concatenated</p></li>
<li><p><strong>method</strong> – method to obtain the entity DoFs dict</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>concatenated entity DoFs dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.enriched.concatenate_entity_permutations">
<span class="sig-prename descclassname"><span class="pre">finat.enriched.</span></span><span class="sig-name descname"><span class="pre">concatenate_entity_permutations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#concatenate_entity_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.concatenate_entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>For each dimension, for each entity, and for each possible
entity orientation, collect the DoF permutation lists from
entity_permutations dicts of elements and concatenate them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elements</strong> – subelements whose DoF permutation lists are concatenated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>entity_permutation dict of the <a class="reference internal" href="#finat.enriched.EnrichedElement" title="finat.enriched.EnrichedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnrichedElement</span></code></a> object
composed of elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.enriched.tree_map">
<span class="sig-prename descclassname"><span class="pre">finat.enriched.</span></span><span class="sig-name descname"><span class="pre">tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/enriched.html#tree_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.enriched.tree_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Like the built-in <a class="reference external" href="https://docs.python.org/3/library/functions.html#map" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">map()</span></code></a>, but applies to a tuple tree.</p>
</dd></dl>

</section>
<section id="module-finat.fiat_elements">
<span id="finat-fiat-elements-module"></span><h2>finat.fiat_elements module<a class="headerlink" href="#module-finat.fiat_elements" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Bernstein">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Bernstein</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Bernstein"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Bernstein" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.BrezziDouglasFortinMarini">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">BrezziDouglasFortinMarini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#BrezziDouglasFortinMarini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.BrezziDouglasFortinMarini" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.BrezziDouglasMarini">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">BrezziDouglasMarini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#BrezziDouglasMarini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.BrezziDouglasMarini" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Bubble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Bubble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Bubble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Bubble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.CrouzeixRaviart">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">CrouzeixRaviart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#CrouzeixRaviart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.CrouzeixRaviart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.DPC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">DPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#DPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.DPC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.DiscontinuousLagrange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">DiscontinuousLagrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#DiscontinuousLagrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.DiscontinuousLagrange" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.DiscontinuousTaylor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">DiscontinuousTaylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#DiscontinuousTaylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.DiscontinuousTaylor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.FacetBubble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">FacetBubble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FacetBubble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FacetBubble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">FiatElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Base class for finite elements for which the tabulation is provided
by FIAT.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.fiat_equivalent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>The FIAT element equivalent to this FInAT element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#FiatElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.FiatElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.FiatElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.fiat_elements.FiatElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.HellanHerrmannJohnson">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">HellanHerrmannJohnson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#HellanHerrmannJohnson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.HellanHerrmannJohnson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.KongMulderVeldhuizen">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">KongMulderVeldhuizen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#KongMulderVeldhuizen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.KongMulderVeldhuizen" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Lagrange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Lagrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Lagrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Lagrange" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Nedelec">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Nedelec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Nedelec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Nedelec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.NedelecSecondKind">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">NedelecSecondKind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#NedelecSecondKind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.NedelecSecondKind" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.RaviartThomas">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">RaviartThomas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#RaviartThomas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.RaviartThomas" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Real">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Real</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Real"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Real" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.DiscontinuousLagrange" title="finat.fiat_elements.DiscontinuousLagrange"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscontinuousLagrange</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Regge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Regge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Regge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Regge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.ScalarFiatElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">ScalarFiatElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#ScalarFiatElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.ScalarFiatElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.ScalarFiatElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.fiat_elements.ScalarFiatElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.Serendipity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">Serendipity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#Serendipity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.Serendipity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityCurl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">TrimmedSerendipityCurl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#TrimmedSerendipityCurl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityCurl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityCurl.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityCurl.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityDiv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">TrimmedSerendipityDiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#TrimmedSerendipityDiv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityDiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityDiv.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityDiv.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">TrimmedSerendipityEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#TrimmedSerendipityEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityEdge.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityEdge.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityFace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">TrimmedSerendipityFace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#TrimmedSerendipityFace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityFace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.VectorFiatElement" title="finat.fiat_elements.VectorFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorFiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.TrimmedSerendipityFace.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.fiat_elements.TrimmedSerendipityFace.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.fiat_elements.VectorFiatElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">VectorFiatElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#VectorFiatElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.VectorFiatElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.fiat_elements.VectorFiatElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.fiat_elements.VectorFiatElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.fiat_elements.point_evaluation">
<span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FiniteElement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CiarletElement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.fiat_elements.point_evaluation_ciarlet">
<span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">point_evaluation_ciarlet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#point_evaluation_ciarlet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.point_evaluation_ciarlet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.fiat_elements.point_evaluation_generic">
<span class="sig-prename descclassname"><span class="pre">finat.fiat_elements.</span></span><span class="sig-name descname"><span class="pre">point_evaluation_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/fiat_elements.html#point_evaluation_generic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.fiat_elements.point_evaluation_generic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-finat.finiteelementbase">
<span id="finat-finiteelementbase-module"></span><h2>finat.finiteelementbase module<a class="headerlink" href="#module-finat.finiteelementbase" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.finiteelementbase.</span></span><span class="sig-name descname"><span class="pre">FiniteElementBase</span></span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.basis_evaluation">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
<li><p><strong>coordinate_mapping</strong> – a
<a class="reference internal" href="#finat.physically_mapped.PhysicalGeometry" title="finat.physically_mapped.PhysicalGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalGeometry</span></code></a> object that
provides physical geometry callbacks (may be None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.cell">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.degree">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.dual_evaluation">
<span class="sig-name descname"><span class="pre">dual_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.dual_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.dual_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a GEM expression for performing the dual basis evaluation at
the nodes of the reference element. Currently only works for flat
elements: tensor elements are implemented in
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFiniteElement</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – Callable representing the function to dual evaluate.
Callable should take in an <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code> and
return a GEM expression for evaluation of the function at
those points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(dual_evaluation_gem_expression,</span> <span class="pre">basis_indices)</span></code>
where the given <code class="docutils literal notranslate"><span class="pre">basis_indices</span></code> are those needed to form a
return expression for the code which is compiled from
<code class="docutils literal notranslate"><span class="pre">dual_evaluation_gem_expression</span></code> (alongside any argument
multiindices already encoded within <code class="docutils literal notranslate"><span class="pre">fn</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.entity_dofs">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.entity_support_dofs">
<span class="sig-name descname"><span class="pre">entity_support_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.entity_support_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.entity_support_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom that have non-zero support on those entities for the
finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.fiat_equivalent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>The FIAT element equivalent to this FInAT element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.formdegree">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.get_indices">
<span class="sig-name descname"><span class="pre">get_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.get_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.get_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple of GEM <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> of the correct extents to loop over
the basis functions of this element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.get_value_indices">
<span class="sig-name descname"><span class="pre">get_value_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.get_value_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.get_value_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple of GEM <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code> of the correct extents to loop over
the value shape of this element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.index_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.mapping">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.point_evaluation">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.space_dimension">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#FiniteElementBase.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.finiteelementbase.FiniteElementBase.value_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.finiteelementbase.FiniteElementBase.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.finiteelementbase.entity_support_dofs">
<span class="sig-prename descclassname"><span class="pre">finat.finiteelementbase.</span></span><span class="sig-name descname"><span class="pre">entity_support_dofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/finiteelementbase.html#entity_support_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.finiteelementbase.entity_support_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of entity id to the degrees of freedom for which
the corresponding basis functions take non-zero values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elem</strong> – FInAT finite element</p></li>
<li><p><strong>entity_dim</strong> – Dimension of the cell subentity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finat.hdivcurl">
<span id="finat-hdivcurl-module"></span><h2>finat.hdivcurl module<a class="headerlink" href="#module-finat.hdivcurl" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.hdivcurl.HCurlElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.hdivcurl.</span></span><span class="sig-name descname"><span class="pre">HCurlElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrappee</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#HCurlElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.HCurlElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.hdivcurl.WrapperElementBase" title="finat.hdivcurl.WrapperElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">WrapperElementBase</span></code></a></p>
<p>H(curl) wrapper element for tensor product elements.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.hdivcurl.HCurlElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/hdivcurl.html#HCurlElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.HCurlElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.HCurlElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.hdivcurl.HCurlElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.HCurlElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.hdivcurl.HCurlElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.hdivcurl.HDivElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.hdivcurl.</span></span><span class="sig-name descname"><span class="pre">HDivElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrappee</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#HDivElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.HDivElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.hdivcurl.WrapperElementBase" title="finat.hdivcurl.WrapperElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">WrapperElementBase</span></code></a></p>
<p>H(div) wrapper element for tensor product elements.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.hdivcurl.HDivElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/hdivcurl.html#HDivElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.HDivElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.HDivElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.hdivcurl.HDivElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.HDivElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.hdivcurl.HDivElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.hdivcurl.</span></span><span class="sig-name descname"><span class="pre">WrapperElementBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrappee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Common base class for H(div) and H(curl) element wrappers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
<li><p><strong>coordinate_mapping</strong> – a
<a class="reference internal" href="#finat.physically_mapped.PhysicalGeometry" title="finat.physically_mapped.PhysicalGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalGeometry</span></code></a> object that
provides physical geometry callbacks (may be None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.entity_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a nested dictionary that gives, for each dimension,
for each entity, and for each possible entity orientation, the
DoF permutation array that maps the entity local DoF ordering
to the canonical global DoF ordering.</p>
<p>The entity permutations <cite>dict</cite> for the degree 4 Lagrange finite
element on the interval, for instance, is given by:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
     <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}}</span>
</pre></div>
</div>
<p>Note that there are two entities on dimension <code class="docutils literal notranslate"><span class="pre">0</span></code> (vertices),
each of which has only one possible orientation, while there is
a single entity on dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> (interval), which has two
possible orientations representing non-reflected and reflected
intervals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.entity_support_dofs">
<span class="sig-name descname"><span class="pre">entity_support_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.entity_support_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.entity_support_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom that have non-zero support on those entities for the
finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#WrapperElementBase.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>A transformation applied on the scalar/vector values of the
wrapped element to produce an H(div) or H(curl) conforming
element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.hdivcurl.WrapperElementBase.wrappee">
<span class="sig-name descname"><span class="pre">wrappee</span></span><a class="headerlink" href="#finat.hdivcurl.WrapperElementBase.wrappee" title="Permalink to this definition">¶</a></dt>
<dd><p>An appropriate tensor product FInAT element whose basis
functions are mapped to produce an H(div) or H(curl)
conforming element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.hdivcurl.select_hcurl_transformer">
<span class="sig-prename descclassname"><span class="pre">finat.hdivcurl.</span></span><span class="sig-name descname"><span class="pre">select_hcurl_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#select_hcurl_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.select_hcurl_transformer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.hdivcurl.select_hdiv_transformer">
<span class="sig-prename descclassname"><span class="pre">finat.hdivcurl.</span></span><span class="sig-name descname"><span class="pre">select_hdiv_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hdivcurl.html#select_hdiv_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hdivcurl.select_hdiv_transformer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-finat.hermite">
<span id="finat-hermite-module"></span><h2>finat.hermite module<a class="headerlink" href="#module-finat.hermite" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.hermite.Hermite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.hermite.</span></span><span class="sig-name descname"><span class="pre">Hermite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hermite.html#Hermite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hermite.Hermite" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.hermite.Hermite.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/hermite.html#Hermite.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.hermite.Hermite.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.mixed">
<span id="finat-mixed-module"></span><h2>finat.mixed module<a class="headerlink" href="#module-finat.mixed" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="finat.mixed.MixedElement">
<span class="sig-prename descclassname"><span class="pre">finat.mixed.</span></span><span class="sig-name descname"><span class="pre">MixedElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor function for FEniCS-style mixed elements.</p>
<p>Implements mixed element using <code class="xref py py-class docutils literal notranslate"><span class="pre">EnrichedElement</span></code> and
value shape transformations with <a class="reference internal" href="#finat.mixed.MixedSubElement" title="finat.mixed.MixedSubElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedSubElement</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.mixed.</span></span><span class="sig-name descname"><span class="pre">MixedSubElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Element wrapper that flattens value shape and places the flattened
vector in a longer vector of zeros.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
<li><p><strong>coordinate_mapping</strong> – a
<a class="reference internal" href="#finat.physically_mapped.PhysicalGeometry" title="finat.physically_mapped.PhysicalGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalGeometry</span></code></a> object that
provides physical geometry callbacks (may be None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.entity_support_dofs">
<span class="sig-name descname"><span class="pre">entity_support_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.entity_support_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.entity_support_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom that have non-zero support on those entities for the
finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mixed.html#MixedSubElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mixed.MixedSubElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mixed.MixedSubElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.mixed.MixedSubElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.morley">
<span id="finat-morley-module"></span><h2>finat.morley module<a class="headerlink" href="#module-finat.morley" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.morley.Morley">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.morley.</span></span><span class="sig-name descname"><span class="pre">Morley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/morley.html#Morley"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.morley.Morley" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.morley.Morley.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/morley.html#Morley.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.morley.Morley.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.mtw">
<span id="finat-mtw-module"></span><h2>finat.mtw module<a class="headerlink" href="#module-finat.mtw" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.mtw.</span></span><span class="sig-name descname"><span class="pre">MardalTaiWinther</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mtw.html#MardalTaiWinther"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mtw.MardalTaiWinther" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicallyMappedElement</span></code></a>, <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther.basis_transformation">
<span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mtw.html#MardalTaiWinther.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mtw.MardalTaiWinther.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther.entity_closure_dofs">
<span class="sig-name descname"><span class="pre">entity_closure_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mtw.html#MardalTaiWinther.entity_closure_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mtw.MardalTaiWinther.entity_closure_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom on the closure of those entities for the finite
element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mtw.html#MardalTaiWinther.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mtw.MardalTaiWinther.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.mtw.MardalTaiWinther.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.mtw.MardalTaiWinther.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/mtw.html#MardalTaiWinther.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.mtw.MardalTaiWinther.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.nodal_enriched">
<span id="finat-nodal-enriched-module"></span><h2>finat.nodal_enriched module<a class="headerlink" href="#module-finat.nodal_enriched" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.nodal_enriched.NodalEnrichedElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.nodal_enriched.</span></span><span class="sig-name descname"><span class="pre">NodalEnrichedElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/nodal_enriched.html#NodalEnrichedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.nodal_enriched.NodalEnrichedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiatElement</span></code></a></p>
<p>An enriched element with a nodal basis.</p>
</dd></dl>

</section>
<section id="module-finat.physically_mapped">
<span id="finat-physically-mapped-module"></span><h2>finat.physically_mapped module<a class="headerlink" href="#module-finat.physically_mapped" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.physically_mapped.DirectlyDefinedElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.physically_mapped.</span></span><span class="sig-name descname"><span class="pre">DirectlyDefinedElement</span></span><a class="reference internal" href="_modules/finat/physically_mapped.html#DirectlyDefinedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.DirectlyDefinedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.NeedsCoordinateMappingElement" title="finat.physically_mapped.NeedsCoordinateMappingElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeedsCoordinateMappingElement</span></code></a></p>
<p>Base class for directly defined elements such as direct
serendipity that bypass a coordinate mapping.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.physically_mapped.NeedsCoordinateMappingElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.physically_mapped.</span></span><span class="sig-name descname"><span class="pre">NeedsCoordinateMappingElement</span></span><a class="reference internal" href="_modules/finat/physically_mapped.html#NeedsCoordinateMappingElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.NeedsCoordinateMappingElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class for elements that require physical information
either to map or construct their basis functions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.physically_mapped.</span></span><span class="sig-name descname"><span class="pre">PhysicalGeometry</span></span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.cell_size">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.cell_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.cell_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The cell size at each vertex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A GEM expression for the cell size, shape (nvertex, ).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.detJ_at">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detJ_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.detJ_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.detJ_at" title="Permalink to this definition">¶</a></dt>
<dd><p>The determinant of the jacobian of the physical coordinates at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> – The point in reference space to evaluate the Jacobian determinant.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A GEM expression for the Jacobian determinant.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.jacobian_at">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacobian_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.jacobian_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.jacobian_at" title="Permalink to this definition">¶</a></dt>
<dd><p>The jacobian of the physical coordinates at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> – The point in reference space (on the cell) to
evaluate the Jacobian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A GEM expression for the Jacobian, shape (gdim, tdim).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.physical_edge_lengths">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physical_edge_lengths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.physical_edge_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.physical_edge_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The length of each edge of the physical cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A GEM expression for the length of each
edge (numbered according to FIAT conventions), shape
(nfacet, ).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.physical_normals">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physical_normals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.physical_normals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.physical_normals" title="Permalink to this definition">¶</a></dt>
<dd><p>The (unit) physical cell normals for each facet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A GEM expression for the normal to each
facet (numbered according to FIAT conventions).  These are
all computed by a clockwise rotation of the physical
tangents, shape (nfacet, gdim).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.physical_points">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physical_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.physical_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.physical_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps reference element points to GEM for the physical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_set</strong> – A point_set on the reference cell to push forward to physical space.</p></li>
<li><p><strong>entity</strong> – Reference cell entity on which the point set is
defined (for example if it is a point set on a facet).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a GEM expression for the physical locations of the
points, shape (gdim, ) with free indices of the point_set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.physical_tangents">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physical_tangents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.physical_tangents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.physical_tangents" title="Permalink to this definition">¶</a></dt>
<dd><p>The (unit) physical cell tangents on each facet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A GEM expression for the tangent to each
facet (numbered according to FIAT conventions).  These
always point from low to high numbered local vertex, shape
(nfacet, gdim).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.physical_vertices">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">physical_vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.physical_vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.physical_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical locations of the cell vertices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a GEM expression for the physical vertices, shape
(gdim, ).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicalGeometry.reference_normals">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reference_normals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicalGeometry.reference_normals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicalGeometry.reference_normals" title="Permalink to this definition">¶</a></dt>
<dd><p>The (unit) reference cell normals for each facet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A GEM expression for the normal to each
facet (numbered according to FIAT conventions), shape
(nfacet, tdim).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicallyMappedElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.physically_mapped.</span></span><span class="sig-name descname"><span class="pre">PhysicallyMappedElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicallyMappedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicallyMappedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.physically_mapped.NeedsCoordinateMappingElement" title="finat.physically_mapped.NeedsCoordinateMappingElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeedsCoordinateMappingElement</span></code></a></p>
<p>A mixin that applies a “physical” transformation to tabulated
basis functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicallyMappedElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicallyMappedElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicallyMappedElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicallyMappedElement.basis_transformation">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicallyMappedElement.basis_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicallyMappedElement.basis_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix for the basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinate_mapping</strong> – Object providing physical geometry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.physically_mapped.PhysicallyMappedElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/physically_mapped.html#PhysicallyMappedElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.physically_mapped.PhysicallyMappedElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-finat.point_set">
<span id="finat-point-set-module"></span><h2>finat.point_set module<a class="headerlink" href="#module-finat.point_set" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.AbstractPointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">AbstractPointSet</span></span><a class="reference internal" href="_modules/finat/point_set.html#AbstractPointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.AbstractPointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A way of specifying a known set of points, perhaps with some
(tensor) structure.</p>
<p>Points, when stored, have shape point_set_shape + (point_dimension,)
where point_set_shape is () for scalar, (N,) for N element vector,
(N, M) for N x M matrix etc.</p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.point_set.AbstractPointSet.dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#finat.point_set.AbstractPointSet.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Point dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.point_set.AbstractPointSet.expression">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expression</span></span><a class="headerlink" href="#finat.point_set.AbstractPointSet.expression" title="Permalink to this definition">¶</a></dt>
<dd><p>GEM expression describing the points, with free indices
<code class="docutils literal notranslate"><span class="pre">self.indices</span></code> and shape (point dimension,).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.point_set.AbstractPointSet.indices">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indices</span></span><a class="headerlink" href="#finat.point_set.AbstractPointSet.indices" title="Permalink to this definition">¶</a></dt>
<dd><p>GEM indices with matching shape and extent to the structure of the
point set.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.point_set.AbstractPointSet.points">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">points</span></span><a class="headerlink" href="#finat.point_set.AbstractPointSet.points" title="Permalink to this definition">¶</a></dt>
<dd><p>A flattened numpy array of points or <code class="docutils literal notranslate"><span class="pre">UnknownPointsArray</span></code>
object with shape (# of points, point dimension).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.GaussLegendrePointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">GaussLegendrePointSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#GaussLegendrePointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.GaussLegendrePointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.PointSet" title="finat.point_set.PointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSet</span></code></a></p>
<p>Gauss-Legendre quadrature points on the interval.</p>
<p>This facilitates implementing discontinuous spectral elements.</p>
<p>Build a PointSet from a vector of points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> – A vector of N points of shape (N, D) where D is the
dimension of each point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.GaussLobattoLegendrePointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">GaussLobattoLegendrePointSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#GaussLobattoLegendrePointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.GaussLobattoLegendrePointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.PointSet" title="finat.point_set.PointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSet</span></code></a></p>
<p>Gauss-Lobatto-Legendre quadrature points on the interval.</p>
<p>This facilitates implementing continuous spectral elements.</p>
<p>Build a PointSet from a vector of points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> – A vector of N points of shape (N, D) where D is the
dimension of each point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.PointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">PointSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#PointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.AbstractPointSet" title="finat.point_set.AbstractPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code></a></p>
<p>A basic point set with no internal structure representing a vector of
points.</p>
<p>Build a PointSet from a vector of points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> – A vector of N points of shape (N, D) where D is the
dimension of each point.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finat.point_set.PointSet.almost_equal">
<span class="sig-name descname"><span class="pre">almost_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#PointSet.almost_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSet.almost_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximate numerical equality of point sets</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSet.expression">
<span class="sig-name descname"><span class="pre">expression</span></span><a class="reference internal" href="_modules/finat/point_set.html#PointSet.expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSet.expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSet.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><a class="reference internal" href="_modules/finat/point_set.html#PointSet.indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSet.indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSet.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="reference internal" href="_modules/finat/point_set.html#PointSet.points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSet.points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.PointSingleton">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">PointSingleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#PointSingleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSingleton" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.AbstractPointSet" title="finat.point_set.AbstractPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code></a></p>
<p>A point set representing a single point.</p>
<p>These have a <code class="docutils literal notranslate"><span class="pre">gem.Literal</span></code> expression and no indices.</p>
<p>Build a PointSingleton from a single point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> – A single point of shape (D,) where D is the dimension of
the point.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSingleton.expression">
<span class="sig-name descname"><span class="pre">expression</span></span><a class="reference internal" href="_modules/finat/point_set.html#PointSingleton.expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSingleton.expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSingleton.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#finat.point_set.PointSingleton.indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.PointSingleton.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="reference internal" href="_modules/finat/point_set.html#PointSingleton.points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.PointSingleton.points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.TensorPointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">TensorPointSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#TensorPointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.TensorPointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.AbstractPointSet" title="finat.point_set.AbstractPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.point_set.TensorPointSet.almost_equal">
<span class="sig-name descname"><span class="pre">almost_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#TensorPointSet.almost_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.TensorPointSet.almost_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximate numerical equality of point sets</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.TensorPointSet.expression">
<span class="sig-name descname"><span class="pre">expression</span></span><a class="reference internal" href="_modules/finat/point_set.html#TensorPointSet.expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.TensorPointSet.expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.TensorPointSet.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><a class="reference internal" href="_modules/finat/point_set.html#TensorPointSet.indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.TensorPointSet.indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.TensorPointSet.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="reference internal" href="_modules/finat/point_set.html#TensorPointSet.points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.TensorPointSet.points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.UnknownPointSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">UnknownPointSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points_expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#UnknownPointSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.UnknownPointSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.point_set.AbstractPointSet" title="finat.point_set.AbstractPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code></a></p>
<p>A point set representing a vector of points with unknown
locations but known <code class="docutils literal notranslate"><span class="pre">gem.Variable</span></code> expression.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.points</span></code> property is an <cite>UnknownPointsArray</cite> object with
shape (N, D) where N is the number of points and D is their
dimension.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.expression</span></code> property is a derived <cite>gem.partial_indexed</cite> with
shape (D,) and free indices for the points N.</p>
<p>Build a PointSingleton from a gem expression for a single point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points_expr</strong> – A <code class="docutils literal notranslate"><span class="pre">gem.Variable</span></code> expression representing a
vector of N points in D dimensions. Should have shape (N, D)
and no free indices. For runtime tabulation the variable
name should begin with ‘<a href="#id3"><span class="problematic" id="id4">rt_</span></a>:’.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.UnknownPointSet.expression">
<span class="sig-name descname"><span class="pre">expression</span></span><a class="reference internal" href="_modules/finat/point_set.html#UnknownPointSet.expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.UnknownPointSet.expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.UnknownPointSet.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><a class="reference internal" href="_modules/finat/point_set.html#UnknownPointSet.indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.UnknownPointSet.indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.point_set.UnknownPointSet.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="reference internal" href="_modules/finat/point_set.html#UnknownPointSet.points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.UnknownPointSet.points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.point_set.UnknownPointsArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.point_set.</span></span><span class="sig-name descname"><span class="pre">UnknownPointsArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/point_set.html#UnknownPointsArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.point_set.UnknownPointsArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A placeholder for a set of unknown points with appropriate length
and size but without indexable values. For use with
:class:<a href="#id1"><span class="problematic" id="id2">`</span></a>AbstractPointSet`s whose points are not known at compile
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – The shape of the unknown set of N points of shape
(N, D) where D is the dimension of each point.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finat.quadrature">
<span id="finat-quadrature-module"></span><h2>finat.quadrature module<a class="headerlink" href="#module-finat.quadrature" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.quadrature.AbstractQuadratureRule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.quadrature.</span></span><span class="sig-name descname"><span class="pre">AbstractQuadratureRule</span></span><a class="reference internal" href="_modules/finat/quadrature.html#AbstractQuadratureRule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.AbstractQuadratureRule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class representing a quadrature rule as point set and a
corresponding set of weights.</p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature.AbstractQuadratureRule.point_set">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">point_set</span></span><a class="headerlink" href="#finat.quadrature.AbstractQuadratureRule.point_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Point set object representing the quadrature points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature.AbstractQuadratureRule.weight_expression">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight_expression</span></span><a class="headerlink" href="#finat.quadrature.AbstractQuadratureRule.weight_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>GEM expression describing the weights, with the same free indices
as the point set.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.quadrature.QuadratureRule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.quadrature.</span></span><span class="sig-name descname"><span class="pre">QuadratureRule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature.html#QuadratureRule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.QuadratureRule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.quadrature.AbstractQuadratureRule" title="finat.quadrature.AbstractQuadratureRule"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractQuadratureRule</span></code></a></p>
<p>Generic quadrature rule with no internal structure.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature.QuadratureRule.point_set">
<span class="sig-name descname"><span class="pre">point_set</span></span><a class="reference internal" href="_modules/finat/quadrature.html#QuadratureRule.point_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.QuadratureRule.point_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature.QuadratureRule.weight_expression">
<span class="sig-name descname"><span class="pre">weight_expression</span></span><a class="reference internal" href="_modules/finat/quadrature.html#QuadratureRule.weight_expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.QuadratureRule.weight_expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.quadrature.TensorProductQuadratureRule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.quadrature.</span></span><span class="sig-name descname"><span class="pre">TensorProductQuadratureRule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature.html#TensorProductQuadratureRule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.TensorProductQuadratureRule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.quadrature.AbstractQuadratureRule" title="finat.quadrature.AbstractQuadratureRule"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractQuadratureRule</span></code></a></p>
<p>Quadrature rule which is a tensor product of other rules.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature.TensorProductQuadratureRule.point_set">
<span class="sig-name descname"><span class="pre">point_set</span></span><a class="reference internal" href="_modules/finat/quadrature.html#TensorProductQuadratureRule.point_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.TensorProductQuadratureRule.point_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature.TensorProductQuadratureRule.weight_expression">
<span class="sig-name descname"><span class="pre">weight_expression</span></span><a class="reference internal" href="_modules/finat/quadrature.html#TensorProductQuadratureRule.weight_expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.TensorProductQuadratureRule.weight_expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.quadrature.make_quadrature">
<span class="sig-prename descclassname"><span class="pre">finat.quadrature.</span></span><span class="sig-name descname"><span class="pre">make_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature.html#make_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature.make_quadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate quadrature rule for given reference element
that will integrate an polynomial of order ‘degree’ exactly.</p>
<p>For low-degree (&lt;=6) polynomials on triangles and tetrahedra, this
uses hard-coded rules, otherwise it falls back to a collapsed
Gauss scheme on simplices.  On tensor-product cells, it is a
tensor-product quadrature rule of the subcells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_el</strong> – The FIAT cell to create the quadrature for.</p></li>
<li><p><strong>degree</strong> – The degree of polynomial that the rule should
integrate exactly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finat.quadrature_element">
<span id="finat-quadrature-element-module"></span><h2>finat.quadrature_element module<a class="headerlink" href="#module-finat.quadrature_element" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.quadrature_element.</span></span><span class="sig-name descname"><span class="pre">QuadratureElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_ref_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>A set of quadrature points pretending to be a finite element.</p>
<p>Construct a <a class="reference internal" href="#finat.quadrature_element.QuadratureElement" title="finat.quadrature_element.QuadratureElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadratureElement</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fiat_ref_cell</strong> – The FIAT reference cell to build the
<a class="reference internal" href="#finat.quadrature_element.QuadratureElement" title="finat.quadrature_element.QuadratureElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadratureElement</span></code></a> on</p></li>
<li><p><strong>rule</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractQuadratureRule</span></code> to use</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#QuadratureElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.quadrature_element.QuadratureElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.quadrature_element.QuadratureElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.quadrature_element.make_quadrature_element">
<span class="sig-prename descclassname"><span class="pre">finat.quadrature_element.</span></span><span class="sig-name descname"><span class="pre">make_quadrature_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fiat_ref_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/quadrature_element.html#make_quadrature_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.quadrature_element.make_quadrature_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#finat.quadrature_element.QuadratureElement" title="finat.quadrature_element.QuadratureElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadratureElement</span></code></a> from a given a reference
element, degree and scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fiat_ref_cell</strong> – The FIAT reference cell to build the
<a class="reference internal" href="#finat.quadrature_element.QuadratureElement" title="finat.quadrature_element.QuadratureElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadratureElement</span></code></a> on.</p></li>
<li><p><strong>degree</strong> – The degree of polynomial that the rule should
integrate exactly.</p></li>
<li><p><strong>scheme</strong> – The quadrature scheme to use - e.g. “default”,
“canonical” or “KMV”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The appropriate <a class="reference internal" href="#finat.quadrature_element.QuadratureElement" title="finat.quadrature_element.QuadratureElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadratureElement</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finat.restricted">
<span id="finat-restricted-module"></span><h2>finat.restricted module<a class="headerlink" href="#module-finat.restricted" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.RestrictedElement">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">RestrictedElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restriction_domain</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#RestrictedElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.RestrictedElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a restricted element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – The element to restrict.</p></li>
<li><p><strong>restriction_domain</strong> – Which entities to restrict to.</p></li>
<li><p><strong>indices</strong> – Indices of basis functions to select (not supported)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new element.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A restriction domain of “interior” means to select the dofs on
the cell, all other domains (e.g. “face”, “edge”) select dofs
in the closure of the entity.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The returned element <em>may not</em> be interpolatory. That is, the
dual basis (if implemented) might not be nodal to the primal
basis. Assembly still works (<code class="docutils literal notranslate"><span class="pre">basis_evaluation</span></code> is fine), but
interpolation may produce bad results.</p>
<p>Restrictions of FIAT-implemented CiarletElements are always
nodal.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.codim_to_r">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">codim_to_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#codim_to_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.codim_to_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.r_to_codim">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">r_to_codim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restriction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#r_to_codim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.r_to_codim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.fiat_elements.FiatElement" title="finat.fiat_elements.FiatElement"><span class="pre">FiatElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.physically_mapped.PhysicallyMappedElement" title="finat.physically_mapped.PhysicallyMappedElement"><span class="pre">PhysicallyMappedElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.cube.FlattenedDimensions" title="finat.cube.FlattenedDimensions"><span class="pre">FlattenedDimensions</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.discontinuous.DiscontinuousElement" title="finat.discontinuous.DiscontinuousElement"><span class="pre">DiscontinuousElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.enriched.EnrichedElement" title="finat.enriched.EnrichedElement"><span class="pre">EnrichedElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.hdivcurl.HCurlElement" title="finat.hdivcurl.HCurlElement"><span class="pre">HCurlElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.hdivcurl.HDivElement" title="finat.hdivcurl.HDivElement"><span class="pre">HDivElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.mixed.MixedSubElement" title="finat.mixed.MixedSubElement"><span class="pre">MixedSubElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.spectral.GaussLobattoLegendre" title="finat.spectral.GaussLobattoLegendre"><span class="pre">GaussLobattoLegendre</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.spectral.GaussLegendre" title="finat.spectral.GaussLegendre"><span class="pre">GaussLegendre</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.tensor_product.TensorProductElement" title="finat.tensor_product.TensorProductElement"><span class="pre">TensorProductElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.tensorfiniteelement.TensorFiniteElement" title="finat.tensorfiniteelement.TensorFiniteElement"><span class="pre">TensorFiniteElement</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finat.trace.HDivTrace" title="finat.trace.HDivTrace"><span class="pre">HDivTrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Restrict an element to a given subentity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – The element to restrict.</p></li>
<li><p><strong>domain</strong> – The subentity to restrict to.</p></li>
<li><p><strong>take_closure</strong> – Gather dofs in closure of the subentities?
Ignored for “interior” domain.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we don’t know how to restrict this
element.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the restricted element is empty.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new finat element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_discontinuous">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_discontinuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_discontinuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_discontinuous" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_enriched">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_enriched</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_enriched"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_enriched" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_fiat">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_fiat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_fiat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_fiat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_flattened_dimensions">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_flattened_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_flattened_dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_flattened_dimensions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_gl">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_gl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_gl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_gl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_gll">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_gll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_gll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_gll" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_hcurl">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_hcurl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_hcurl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_hcurl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_hdiv">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_hdiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_hdiv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_hdiv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_hdivtrace">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_hdivtrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_hdivtrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_hdivtrace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_mixed">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_mixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_mixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_mixed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_physically_mapped">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_physically_mapped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_physically_mapped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_physically_mapped" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_tfe">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_tfe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_tfe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_tfe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.restricted.restrict_tpe">
<span class="sig-prename descclassname"><span class="pre">finat.restricted.</span></span><span class="sig-name descname"><span class="pre">restrict_tpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">take_closure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/restricted.html#restrict_tpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.restricted.restrict_tpe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-finat.runtime_tabulated">
<span id="finat-runtime-tabulated-module"></span><h2>finat.runtime_tabulated module<a class="headerlink" href="#module-finat.runtime_tabulated" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.runtime_tabulated.</span></span><span class="sig-name descname"><span class="pre">RuntimeTabulated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restriction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>Element placeholder for tabulations provided at run time through a
kernel argument.</p>
<p>Used by Themis.</p>
<p>Construct a runtime tabulated element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> – reference cell</p></li>
<li><p><strong>degree</strong> – polynomial degree (int)</p></li>
<li><p><strong>variant</strong> – variant string of the UFL element</p></li>
<li><p><strong>shift_axes</strong> – first dimension</p></li>
<li><p><strong>restriction</strong> – None for single-cell integrals, ‘+’ or ‘-’
for interior facet integrals depending on
which we need the tabulation on</p></li>
<li><p><strong>continuous</strong> – continuous or discontinuous element?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.degree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.degree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.formdegree">
<span class="sig-name descname"><span class="pre">formdegree</span></span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.formdegree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.formdegree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/runtime_tabulated.html#RuntimeTabulated.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.runtime_tabulated.RuntimeTabulated.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.runtime_tabulated.RuntimeTabulated.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.spectral">
<span id="finat-spectral-module"></span><h2>finat.spectral module<a class="headerlink" href="#module-finat.spectral" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.spectral.FDMHermite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.spectral.</span></span><span class="sig-name descname"><span class="pre">FDMHermite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#FDMHermite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.FDMHermite" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<p>1D CG element with FDM shape functions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.spectral.FDMLagrange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.spectral.</span></span><span class="sig-name descname"><span class="pre">FDMLagrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#FDMLagrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.FDMLagrange" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<p>1D CG element with FDM shape functions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.spectral.GaussLegendre">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.spectral.</span></span><span class="sig-name descname"><span class="pre">GaussLegendre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#GaussLegendre"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.GaussLegendre" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<p>1D discontinuous element with nodes at the Gauss-Legendre points.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.spectral.GaussLegendre.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#GaussLegendre.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.GaussLegendre.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finat.spectral.GaussLobattoLegendre">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.spectral.</span></span><span class="sig-name descname"><span class="pre">GaussLobattoLegendre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#GaussLobattoLegendre"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.GaussLobattoLegendre" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
<p>1D continuous element with nodes at the Gauss-Lobatto points.</p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.spectral.GaussLobattoLegendre.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/spectral.html#GaussLobattoLegendre.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.spectral.GaussLobattoLegendre.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.sympy2gem">
<span id="finat-sympy2gem-module"></span><h2>finat.sympy2gem module<a class="headerlink" href="#module-finat.sympy2gem" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Add</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Add</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Integer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Integer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Rational</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Rational</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_add">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_expr">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_expr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_expr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_float">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_float" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_integer">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_integer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_integer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_integer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_mul">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_mul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_mul" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_pow">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_pow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_pow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_rational">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_rational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_rational"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_rational" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.sympy2gem.sympy2gem_symbol">
<span class="sig-prename descclassname"><span class="pre">finat.sympy2gem.</span></span><span class="sig-name descname"><span class="pre">sympy2gem_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/sympy2gem.html#sympy2gem_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.sympy2gem.sympy2gem_symbol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-finat.tensor_product">
<span id="finat-tensor-product-module"></span><h2>finat.tensor_product module<a class="headerlink" href="#module-finat.tensor_product" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.tensor_product.</span></span><span class="sig-name descname"><span class="pre">TensorProductElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at known points on the
reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>ps</strong> – the point set object.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
<li><p><strong>coordinate_mapping</strong> – a
<a class="reference internal" href="#finat.physically_mapped.PhysicalGeometry" title="finat.physically_mapped.PhysicalGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalGeometry</span></code></a> object that
provides physical geometry callbacks (may be None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.tensor_product.TensorProductElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.tensor_product.TensorProductElement.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.entity_permutations">
<span class="sig-name descname"><span class="pre">entity_permutations</span></span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.entity_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.entity_permutations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.fiat_equivalent">
<span class="sig-name descname"><span class="pre">fiat_equivalent</span></span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.fiat_equivalent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.fiat_equivalent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.formdegree">
<span class="sig-name descname"><span class="pre">formdegree</span></span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.formdegree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.tensor_product.TensorProductElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.mapping">
<span class="sig-name descname"><span class="pre">mapping</span></span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#TensorProductElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.TensorProductElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensor_product.TensorProductElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.tensor_product.TensorProductElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.tensor_product.compose_permutations">
<span class="sig-prename descclassname"><span class="pre">finat.tensor_product.</span></span><span class="sig-name descname"><span class="pre">compose_permutations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#compose_permutations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.compose_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>For the <a class="reference internal" href="#finat.tensor_product.TensorProductElement" title="finat.tensor_product.TensorProductElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorProductElement</span></code></a> object composed of factors,
construct, for each dimension tuple, for each entity, and for each possible
entity orientation combination, the DoF permutation list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factors</strong> – element factors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>entity_permutation dict of the <a class="reference internal" href="#finat.tensor_product.TensorProductElement" title="finat.tensor_product.TensorProductElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorProductElement</span></code></a> object
composed of factors.</p>
</dd>
</dl>
<p>For tensor-product elements, one needs to consider two kinds of orientations:
extrinsic orientations and intrinsic (“material”) orientations.</p>
<p>Example:</p>
<p>UFCQuadrilateral := UFCInterval x UFCInterval</p>
<p>eo (extrinsic orientation): swap axes (X -&gt; y, Y-&gt; x)
io (intrinsic orientation): reflect component intervals
o (total orientation)     : (2 ** dim) * eo + io</p>
<p>eoio    0      1      2      3</p>
<blockquote>
<div><blockquote>
<div><p>1—3  0—2  3—1  2—0</p>
</div></blockquote>
<dl>
<dt>0    |   |  |   |  |   |  |   |</dt><dd><p>0—2  1—3  2—0  3—1</p>
<p>2—3  3—2  0—1  1—0</p>
</dd>
<dt>1    |   |  |   |  |   |  |   |</dt><dd><p>0—1  1—0  2—3  3—2</p>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ufl</span>
<span class="kn">import</span> <span class="nn">FIAT</span>
<span class="kn">import</span> <span class="nn">finat</span>

<span class="n">cell</span> <span class="o">=</span> <span class="n">FIAT</span><span class="o">.</span><span class="n">ufc_cell</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">finat</span><span class="o">.</span><span class="n">DiscontinuousLagrange</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">finat</span><span class="o">.</span><span class="n">TensorProductElement</span><span class="p">([</span><span class="n">elem</span><span class="p">,</span> <span class="n">elem</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">entity_permutations</span><span class="p">)</span>
</pre></div>
</div>
<p>prints:</p>
<dl>
<dt>{(0, 0): {0: {(0, 0, 0): []},</dt><dd><blockquote>
<div><p>1: {(0, 0, 0): []},
2: {(0, 0, 0): []},
3: {(0, 0, 0): []}},</p>
</div></blockquote>
<dl>
<dt>(0, 1): {0: {(0, 0, 0): [],</dt><dd><blockquote>
<div><p>(0, 0, 1): []},</p>
</div></blockquote>
<dl class="simple">
<dt>1: {(0, 0, 0): [],</dt><dd><p>(0, 0, 1): []}},</p>
</dd>
</dl>
</dd>
<dt>(1, 0): {0: {(0, 0, 0): [],</dt><dd><blockquote>
<div><p>(0, 1, 0): []},</p>
</div></blockquote>
<dl class="simple">
<dt>1: {(0, 0, 0): [],</dt><dd><p>(0, 1, 0): []}},</p>
</dd>
</dl>
</dd>
<dt>(1, 1): {0: {(0, 0, 0): [0, 1, 2, 3],</dt><dd><p>(0, 0, 1): [1, 0, 3, 2],
(0, 1, 0): [2, 3, 0, 1],
(0, 1, 1): [3, 2, 1, 0],
(1, 0, 0): [0, 2, 1, 3],
(1, 0, 1): [2, 0, 3, 1],
(1, 1, 0): [1, 3, 0, 2],
(1, 1, 1): [3, 1, 2, 0]}}}</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.tensor_product.factor_point_set">
<span class="sig-prename descclassname"><span class="pre">finat.tensor_product.</span></span><span class="sig-name descname"><span class="pre">factor_point_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">product_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#factor_point_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.factor_point_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Factors a point set for the product element into a point sets for
each subelement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>product_cell</strong> – a TensorProductCell</p></li>
<li><p><strong>product_dim</strong> – entity dimension for the product cell</p></li>
<li><p><strong>point_set</strong> – point set for the product element</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finat.tensor_product.productise">
<span class="sig-prename descclassname"><span class="pre">finat.tensor_product.</span></span><span class="sig-name descname"><span class="pre">productise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensor_product.html#productise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensor_product.productise" title="Permalink to this definition">¶</a></dt>
<dd><p>Tensor product the dict mapping topological entities to dofs across factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factors</strong> – element factors.</p></li>
<li><p><strong>method</strong> – instance method to call on each factor to get dofs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finat.tensorfiniteelement">
<span id="finat-tensorfiniteelement-module"></span><h2>finat.tensorfiniteelement module<a class="headerlink" href="#module-finat.tensorfiniteelement" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.tensorfiniteelement.</span></span><span class="sig-name descname"><span class="pre">TensorFiniteElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.finiteelementbase.FiniteElementBase" title="finat.finiteelementbase.FiniteElementBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElementBase</span></code></a></p>
<p>A Finite element whose basis functions have the form:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol\phi_{i \alpha \beta} = \mathbf{e}_{\alpha} \mathbf{e}_{\beta}^{\mathrm{T}}\phi_i\]</div>
<p>Where <span class="math notranslate nohighlight">\(\{\mathbf{e}_\alpha,\, \alpha=0\ldots\mathrm{shape[0]}\}\)</span> and
<span class="math notranslate nohighlight">\(\{\mathbf{e}_\beta,\, \beta=0\ldots\mathrm{shape[1]}\}\)</span> are
the bases for <span class="math notranslate nohighlight">\(\mathbb{R}^{\mathrm{shape[0]}}\)</span> and
<span class="math notranslate nohighlight">\(\mathbb{R}^{\mathrm{shape[1]}}\)</span> respectively; and
<span class="math notranslate nohighlight">\(\{\phi_i\}\)</span> is the basis for the corresponding scalar
finite element space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – The scalar finite element.</p></li>
<li><p><strong>shape</strong> – The geometric shape of the tensor element.</p></li>
<li><p><strong>transpose</strong> – Changes the DoF ordering from the
Firedrake-style XYZ XYZ XYZ XYZ to the
FEniCS-style XXXX YYYY ZZZZ.  That is,
tensor shape indices come before the scalar
basis function indices when transpose=True.</p></li>
</ul>
</dd>
</dl>
<p><span class="math notranslate nohighlight">\(\boldsymbol\phi_{i\alpha\beta}\)</span> is, of course, tensor-valued. If
we subscript the vector-value with <span class="math notranslate nohighlight">\(\gamma\epsilon\)</span> then we can write:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol\phi_{\gamma\epsilon(i\alpha\beta)} = \delta_{\gamma\alpha}\delta_{\epsilon\beta}\phi_i\]</div>
<p>This form enables the simplification of the loop nests which
will eventually be created, so it is the form we employ here.</p>
<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.base_element">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_element</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.base_element" title="Permalink to this definition">¶</a></dt>
<dd><p>The base element of this tensor element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.basis_evaluation">
<span class="sig-name descname"><span class="pre">basis_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement.basis_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.basis_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce the recipe for basis function evaluation at a set of points <span class="math notranslate nohighlight">\(q\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\boldsymbol\phi_{(\gamma \epsilon) (i \alpha \beta) q} = \delta_{\alpha \gamma} \delta_{\beta \epsilon}\phi_{i q}\\\nabla\boldsymbol\phi_{(\epsilon \gamma \zeta) (i \alpha \beta) q} = \delta_{\alpha \epsilon} \delta_{\beta \gamma}\nabla\phi_{\zeta i q}\end{aligned}\end{align} \]</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference cell on which the element is defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>The degree of the embedding polynomial space.</p>
<p>In the tensor case this is a tuple.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.dual_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dual_basis</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dual evaluation gem weight tensor Q and point set x to dual
evaluate a function fn at.</p>
<p>The general dual evaluation is then Q * fn(x) (the contraction of Q
with fn(x) along the the indices of x and any shape introduced by fn).</p>
<p>If the dual weights are scalar then Q, for a general scalar FIAT
element, is a matrix with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points)
</pre></div>
</div>
<p>If the dual weights are tensor valued then Q, for a general tensor
valued FIAT element, is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes, num_points, dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>If the dual basis is of a tensor product or FlattenedDimensions element
with N factors then Q in general is a tensor with dimensions</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(num_nodes_factor1, ..., num_nodes_factorN,
 num_points_factor1, ..., num_points_factorN,
 dual_weight_shape[0], ..., dual_weight_shape[n])
</pre></div>
</div>
<p>where num_points_factorX are made free indices that match the free
indices of x (which is now a TensorPointSet).</p>
<p>If the dual basis is of a tensor finite element with some shape
(S1, S2, …, Sn) then the tensor element tQ is constructed from the
base element’s Q by taking the outer product with appropriately sized
identity matrices:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tQ = Q ⊗ 𝟙ₛ₁ ⊗ 𝟙ₛ₂ ⊗ ... ⊗ 𝟙ₛₙ
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When Q is returned, the contraction indices of the point set are
already free indices rather than being left in its shape (as either
<code class="docutils literal notranslate"><span class="pre">num_points</span></code> or <code class="docutils literal notranslate"><span class="pre">num_points_factorX</span></code>). This is to avoid index
labelling confusion when performing the dual evaluation
contraction.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FIAT element dual bases are built from their <code class="docutils literal notranslate"><span class="pre">Functional.pt_dict</span></code>
properties. Therefore any FIAT dual bases with derivative nodes
represented via a <code class="docutils literal notranslate"><span class="pre">Functional.deriv_dict</span></code> property does not
currently have a FInAT dual basis.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.dual_evaluation">
<span class="sig-name descname"><span class="pre">dual_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement.dual_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.dual_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a GEM expression for performing the dual basis evaluation at
the nodes of the reference element. Currently only works for flat
elements: tensor elements are implemented in
<a class="reference internal" href="#finat.tensorfiniteelement.TensorFiniteElement" title="finat.tensorfiniteelement.TensorFiniteElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFiniteElement</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – Callable representing the function to dual evaluate.
Callable should take in an <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPointSet</span></code> and
return a GEM expression for evaluation of the function at
those points.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(dual_evaluation_gem_expression,</span> <span class="pre">basis_indices)</span></code>
where the given <code class="docutils literal notranslate"><span class="pre">basis_indices</span></code> are those needed to form a
return expression for the code which is compiled from
<code class="docutils literal notranslate"><span class="pre">dual_evaluation_gem_expression</span></code> (alongside any argument
multiindices already encoded within <code class="docutils literal notranslate"><span class="pre">fn</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.entity_dofs">
<span class="sig-name descname"><span class="pre">entity_dofs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement.entity_dofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.entity_dofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the map of topological entities to degrees of
freedom for the finite element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.formdegree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formdegree</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.formdegree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the associated form (FEEC)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.index_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_shape</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.index_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the number of degrees of freedom in the
element. For example a scalar quadratic Lagrange element on a triangle
would return (6,) while a vector valued version of the same element
would return (6, 2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mapping</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Appropriate mapping from the reference cell to a physical cell for
all basis functions of the finite element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.point_evaluation">
<span class="sig-name descname"><span class="pre">point_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement.point_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.point_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return code for evaluating the element at an arbitrary points on
the reference element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – return derivatives up to this order.</p></li>
<li><p><strong>refcoords</strong> – GEM expression representing the coordinates
on the reference entity.  Its shape must be
a vector with the correct dimension, its
free indices are arbitrary.</p></li>
<li><p><strong>entity</strong> – the cell entity on which to tabulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/tensorfiniteelement.html#TensorFiniteElement.space_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the finite element space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finat.tensorfiniteelement.TensorFiniteElement.value_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_shape</span></span><a class="headerlink" href="#finat.tensorfiniteelement.TensorFiniteElement.value_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple indicating the shape of the element.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-finat.trace">
<span id="finat-trace-module"></span><h2>finat.trace module<a class="headerlink" href="#module-finat.trace" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="finat.trace.HDivTrace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finat.trace.</span></span><span class="sig-name descname"><span class="pre">HDivTrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/finat/trace.html#HDivTrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#finat.trace.HDivTrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finat.fiat_elements.ScalarFiatElement" title="finat.fiat_elements.ScalarFiatElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarFiatElement</span></code></a></p>
</dd></dl>

</section>
<section id="module-finat">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-finat" title="Permalink to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014--2020, David A. Ham, Robert C. Kirby and others.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>